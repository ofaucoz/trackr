<!DOCTYPE html>
<html>
  <head>
    <title>Map</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
    html,
    body {
      font-family: Arial, sans-serif;
      height: 100%;
      margin: 0;
      padding: 0;
    }
    .container {
      height: 100%;
      position: relative;
    }
    input {
      font-size: 12px;
    }
    h1 {
      color: #525454;
      font-size: 22px;
      margin: 0 0 10px 0;
      text-align: center;
    }
    #hide-listings,
    #show-listings {
      width: 48%;
    }
    #map {
      bottom:0px;
      height: 100%;
      left: 362px;
      position: absolute;
      right: 0px;
    }
    .options-box {
      background: #fff;
      border: 1px solid #999;
      border-radius: 3px;
      height: 100%;
      line-height: 35px;
      padding: 10px 10px 30px 10px;
      text-align: left;
      width: 340px;
    }
  </style>
  </head>
  <body>
    <!--First we have to add two buttoms -->
    <div class="container">
      <div class="options-box">
        <h1> Track the Tweet</h1>
        <div>
          <!--we will create some listener fuctions for do something when
          the buttom is press -->
          <input id="show-listings" type="button" value="Show it!">
          <input id="hide-listings" type="button" value="Hide it!">
        </div>
      </div>

    <div id="map"></div>
    <script>
    var map;

    var markers = [];
    //Sometimes is important styles for being in line with your brand.
    //Some interesting links:
    //https://developers.google.com/maps/documentation/javascript/styling
    //https://developers.google.com/maps/documentation/javascript/styling#creating_a_styledmaptype
    //https://snazzymaps.com/

      function initMap() {
        //Creat a style array to use with the map
        var styles = [
          {
            featureType: 'water',
            stylers: [
              { color: '#19a0d8' }
            ]
          },{
            featureType: 'administrative',
            elementType: 'labels.text.stroke',
            stylers: [
              { color: '#ffffff' },
              { weight: 6 }
            ]
          },{
            featureType: 'administrative',
            elementType: 'labels.text.fill',
            stylers: [
              { color: '#e85113' }
            ]
          },{
            featureType: 'road.highway',
            elementType: 'geometry.stroke',
            stylers: [
              { color: '#efe9e4' },
              { lightness: -40 }
            ]
          },{
            featureType: 'transit.station',
            stylers: [
              { weight: 9 },
              { hue: '#e85113' }
            ]
          },{
            featureType: 'road.highway',
            elementType: 'labels.icon',
            stylers: [
              { visibility: 'off' }
            ]
          },{
            featureType: 'water',
            elementType: 'labels.text.stroke',
            stylers: [
              { lightness: 100 }
            ]
          },{
            featureType: 'water',
            elementType: 'labels.text.fill',
            stylers: [
              { lightness: -100 }
            ]
          },{
            featureType: 'poi',
            elementType: 'geometry',
            stylers: [
              { visibility: 'on' },
              { color: '#f0e4d3' }
            ]
          },{
            featureType: 'road.highway',
            elementType: 'geometry.fill',
            stylers: [
              { color: '#efe9e4' },
              { lightness: -25 }
            ]
          }
        ];

        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 15,
          center: {lat: 47.0707, lng: 15.4395},
          //set the styles property within the map object options
          styles: styles,
          //We dont allow the user to change the type
          mapTypeControl: false
        });

        var locations = [
          {title: 'Atl Technic', location: {lat: 47.068971, lng: 15.450100}},
          {title: 'Kopernikun', location: {lat: 47.064993, lng: 15.450765}},
          {title: 'Infel', location: {lat: 47.058339, lng: 15.457897}}
        ];

        var largeInfowindow = new google.maps.InfoWindow();

        //FUNCTION TO CHANFE THE COLOR OF THE MARKER

        //Style the markers a bit. This will be our listing marker icon
        var defaultIcon = makeMarkerIcon('0091ff');

        //Create a "highlighted location" marker color for when the user
        //mouses over the marker.
        var highlightedIcon = makeMarkerIcon('FFFF24');

        // The following group uses the location array to create an array of markers on initialize.
        for (var i = 0; i < locations.length; i++) {
          // Get the position from the location array.
          var position = locations[i].location;
          var title = locations[i].title;
          // Create a marker per location, and put into markers array.
           var marker = new google.maps.Marker({
            position: position,
            title: title,
            //Set the default icon
            icon: defaultIcon,
            animation: google.maps.Animation.DROP,
            id: i
          });
          // Push the marker to our array of markers.
          markers.push(marker);
          // Create an onclick event to open an infowindow at each marker.
          marker.addListener('click', function() {
            populateInfoWindow(this, largeInfowindow);
          });

          //Two event listeners - one for mouseover, one for mouseout,
          //to change the colors back and forth
          //IF i have a lot of tweets it is going to be really useful

          marker.addListener('mouseover', function() {
           this.setIcon(highlightedIcon);
         });
         marker.addListener('mouseout', function() {
           this.setIcon(defaultIcon);
         });

        }
        document.getElementById('show-listings').addEventListener('click', showListings);
        document.getElementById('hide-listings').addEventListener('click', hideListings);
      }



      function populateInfoWindow(marker, infowindow) {
        // Check to make sure the infowindow is not already opened on this marker.
        if (infowindow.marker != marker) {
          infowindow.marker = marker;
          infowindow.setContent('<div>' + marker.title + '</div>' + marker.position);
          infowindow.open(map, marker);
          // Make sure the marker property is cleared if the infowindow is closed.
          infowindow.addListener('closeclick', function() {
            infowindow.marker = null;
          });
        }
      }
      // This function will loop through the markers array and display them all.
      function showListings() {
        var bounds = new google.maps.LatLngBounds();
        // Extend the boundaries of the map for each marker and display the marker
        for (var i = 0; i < markers.length; i++) {
          markers[i].setMap(map);
          bounds.extend(markers[i].position);
        }
        map.fitBounds(bounds);
      }
      // This function will loop through the listings and hide them all.
      function hideListings() {
        for (var i = 0; i < markers.length; i++) {
          markers[i].setMap(null);
        }
      }

      function makeMarkerIcon(markerColor){
        var markerImage = new google.maps.MarkerImage(
          'http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|'+ markerColor +
          '|40|_|%E2%80%A2',
          new google.maps.Size(21, 34),
          new google.maps.Point(0, 0),
          new google.maps.Point(10, 34),
          new google.maps.Size(21,34));
        return markerImage;
      }

      </script>

    <script async defer
        src="https://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyD8js0g9CIUjRNTj-wdE-SMN_2xT9fZmGA&callback=initMap">
    </script>

  </body>
</html>
